# AI对冲基金项目部署改造需求说明

## 项目概述
本文档描述了AI对冲基金项目的两个主要改造需求：硅基流动LLM模型集成和Web前端服务Docker化部署。

## 改造需求

### 需求1: 硅基流动(SiliconFlow)LLM模型集成

#### 目标
集成硅基流动API，支持新的大语言模型进行AI投资决策分析。

#### 技术约束条件
- **API集成**: 必须支持SiliconFlow API接口
- **目标模型**: 必须集成以下指定模型
  - `Pro/deepseek-ai/DeepSeek-R1`
  - `Qwen/Qwen3-32B`
- **兼容性**: 必须与现有LLM框架完全兼容，不破坏现有功能
- **配置**: 必须支持环境变量 `SILICONFLOW_API_KEY` 进行API密钥配置
- **错误处理**: 必须实现完整的API调用异常处理机制

#### 实现文件范围
```
src/llm/
├── models.py              # 添加SiliconFlow提供商支持
├── api_models.json        # 添加新模型配置
└── ollama_models.json     # 保持不变

app/frontend/src/
└── data/models.ts         # 同步新模型到前端选择器
```

#### 环境变量新增
```bash
# .env 文件新增
SILICONFLOW_API_KEY=your-siliconflow-api-key
```

---

### 需求2: Web前端服务Docker化部署

#### 目标
将现有命令行交互完全转换为Web界面，并实现Docker容器化部署。

#### 核心约束条件

##### 前端架构约束
- **完全按照现有逻辑**: 必须保持 `app/frontend` 的现有架构不变
- **ReactFlow架构**: 必须保持 `App.tsx` 基于Flow组件的UI结构
- **Layout系统**: 必须保持现有 Layout + Flow 的界面布局
- **UI框架**: 必须继续使用 shadcn/ui + Tailwind CSS 设计系统
- **技术栈**: 必须保持 Vite + React + TypeScript 的现有生态

##### 启动逻辑约束
- **脚本兼容**: 必须按照现有 `app/run.sh` 脚本的逻辑实现Docker版本
- **端口配置**: 必须保持前端端口5173、后端端口8000的现有配置
- **依赖管理**: 必须保持Poetry（后端）+ npm（前端）的现有方式
- **一键启动**: 必须实现等效于 `./run.sh` 的Docker启动命令

##### 服务架构约束
- **前端服务**: 完全按照 `app/frontend` 结构和现有技术栈
- **后端服务**: 保持 `app/backend` 的FastAPI架构不变  
- **环境配置**: 复用根目录 `.env` 的现有配置方式
- **浏览器集成**: 保持自动打开浏览器到 http://localhost:5173 的逻辑

#### Docker部署约束
- **容器化**: 所有服务必须完全Docker容器化
- **编排工具**: 必须使用Docker Compose进行服务编排
- **网络配置**: 必须正确配置容器间网络通信
- **数据持久化**: 必须妥善处理环境变量和配置文件的挂载

#### 功能保持约束
- **完整功能**: 必须保持现有所有功能（交易决策、回测、代理选择等）
- **实时性**: 必须支持实时数据展示和WebSocket通信
- **用户体验**: 必须提供与命令行版本等效的用户交互体验
- **API兼容**: 必须与现有后端API完全兼容

## 技术标准

### 代码质量标准
- 遵循现有代码风格和架构模式
- 保持现有错误处理和日志记录方式
- 维护现有测试覆盖率水平

### 性能标准
- Docker启动时间不超过60秒
- Web界面响应时间不超过现有命令行版本
- API调用响应时间保持现有水平

### 兼容性标准
- 支持Linux、macOS、Windows的Docker环境
- 兼容现有的所有环境变量配置
- 向后兼容现有的API接口

## 部署验证标准

### 功能验证
- [ ] SiliconFlow模型可正常调用
- [ ] Web界面完全替代命令行交互
- [ ] Docker容器可正常启动和停止
- [ ] 所有现有功能在Web界面中正常工作

### 性能验证  
- [ ] 容器启动时间符合标准
- [ ] Web界面响应速度符合要求
- [ ] API调用性能无显著下降

### 用户体验验证
- [ ] 一键启动成功率100%
- [ ] 浏览器自动打开正常
- [ ] 界面操作流程直观易用

---

**注意事项**: 本改造严格按照现有项目架构进行，不允许改变核心技术栈和架构模式，确保改造后系统的稳定性和可维护性。 